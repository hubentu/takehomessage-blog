---
date: 2019/12/17
tag:
  - rstats
  - tidytuesday
---

# 
```{r}
dog_moves <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_moves.csv')
dog_travel <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_travel.csv')
dog_descriptions <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_descriptions.csv')

library(tidyverse)
dog_descriptions %>% left_join(dog_travel)


library(geofacet)
dog_ie <- dog_moves %>% filter(inUS) %>%
    mutate(location = replace(location,
                              location=="Washington DC",
                              "District of Columbia")) %>%
    select(location, exported, imported, total)
tc <- dog_ie %>% pull(total) %>% max %>% sqrt %>% ceiling
tc <- 30

dog_blocks <- dog_ie %>% select(location, exported, imported) %>%
    pmap_dfr(function(location, exported, imported){
        df <- data.frame(state = rep(location, tc^2),
                         x = rep(seq(tc), each = tc),
                         y = rep(seq(tc), tc),
                         z = NA,
                         stringsAsFactors = FALSE)
    if(!is.na(exported)){
        df[seq(exported), "z"] <- "exported"
    }
    if(!is.na(imported)){
        df[tail(seq(tc^2), imported), "z"] <- "imported"
    }
    df
})

ggplot(dog_blocks) +
    geom_tile(aes(x, y, fill=z), width=0.8, height=0.8) +
    scale_fill_manual(values=c("red", "blue")) +
    theme_bw() + theme(legend.position = "none") +
    labs(x = "", y = "") +
    facet_geo( ~ state, grid = "us_state_grid2") +
    theme_minimal() +
    theme(axis.title.x=element_blank(),
          axis.text.x=element_blank(),
          axis.ticks.x=element_blank(),
          axis.title.y=element_blank(),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank()) +
    labs(x = "", y = "", title = "Dog imported and exported", fill = "") +
    scale_colour_discrete(na.translate = F)

```
